---
const features = [
  {
    title: "Streamline Emergency Care with Instant Intake",
    description: "Our Instant Intake feature equips ER doctors with the relevant data from a patients medical history based on the symptoms the patient is exhibiting. Our state of the art RAG pipeline ensures better than human retrieval precision so you can move with confidence.",
    stats: [
      {
        number: "20k",
        text: "A prominent medical center in Ohio successfully reduced patient intake time by approximately 20,000 hours"
      },
      {
        number: "$3M",
        text: "This amounts to over $3 million in care provider time, not to mention the significant impact on patient outcomes."
      }
    ],
    image: "/images/InstantIntage1080.gif"
  },
  {
    title: "Clinical Decision Support",
    description: "Access the latest medical research pertinent to your patient's medical history effortlessly. Evaluate abstracts of pier reviewed articles. The AI-generated response offers potential next steps grounded in the most current medical findings.",
    image: "/images/DecisionSupport1080.gif"
  },
  {
    title: "Transforming Medical Research: Save Time and Enhance Data Quality Effortlessly",
    description: "Our system significantly reduces the time spent on data compilation, allowing researchers to focus on analysis and discovery. With automated processes, the quality of data is improved, ensuring more reliable results.",
    stats: [
      {
        number: "150x",
        text: "Accelerate the creation of analysis-ready datasets by 150x."
      },
      {
        number: "99.4%",
        text: "Achieved a 99.4% reduction in the time required to establish a fully operational data set."
      }
    ],
    image: "/images/Research1080.gif"
  },
  {
    title: "Seamless EMR Integration",
    description: "Connect instantly to your existing EMR system. We currently integrate with Epic, allowing you to access patient data securely and efficiently. Our roadmap includes integration with other major EMR providers to ensure comprehensive coverage across healthcare systems.",
    stats: [
      {
        number: "1-Click",
        text: "Single sign-on integration with Epic means instant access to your existing workflow"
      },
      {
        number: "2025",
        text: "Expanding integration to Cerner, Meditech, and other major EMR systems"
      }
    ],
    image: "/images/CNLogin1080.gif"
  }
];
---

<section class="features">
  {features.map((feature, index) => (
    <div class="feature-card" data-index={index}>
      <div class={`feature-content ${index % 2 === 1 ? 'order-2' : ''}`}>
        <h2>{feature.title}</h2>
        <p>{feature.description}</p>
        {feature.stats && (
          <div class="stats">
            {feature.stats.map(stat => (
              <div class="stat-item">
                <h3>{stat.number}</h3>
                <p>{stat.text}</p>
              </div>
            ))}
          </div>
        )}
      </div>
      <div class={`feature-image ${index % 2 === 1 ? 'order-1' : ''}`}>
        <img src={feature.image} alt={feature.title} />
      </div>
    </div>
  ))}
</section>

<style>
  .features {
    position: relative;
    height: 400vh;
    background: white;
  }

  .feature-card {
    position: sticky;
    top: 0;
    left: 0;
    right: 0;
    height: 100vh;
    display: flex;
    gap: 2rem;
    align-items: center;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.8s ease, visibility 0.8s ease;
    padding: 0 2rem;
    max-width: 1200px;
    margin: 0 auto;
    background: white;
  }

  .feature-card.visible {
    opacity: 1;
    visibility: visible;
  }

  .feature-content {
    flex: 1;
  }

  .feature-content h2 {
    font-size: 2rem;
    margin-bottom: 1rem;
    line-height: 1.2;
  }

  .feature-content p {
    color: #666;
    margin-bottom: 1.5rem;
  }

  .feature-image {
    flex: 1;
    background: #f5f5f5;
    border-radius: 8px;
    overflow: hidden;
  }

  .feature-image img {
    width: 100%;
    height: auto;
    display: block;
  }

  .stats {
    display: flex;
    gap: 2rem;
    margin-top: 1.5rem;
  }

  .stat-item h3 {
    font-size: 2rem;
    color: var(--primary-color);
    background: linear-gradient(135deg, #50B9C6 0%, #3da7b4 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .stat-item p {
    font-size: 0.9rem;
    margin-top: 0.5rem;
  }

  .order-1 {
    order: 1;
  }

  .order-2 {
    order: 2;
  }

  @media (max-width: 768px) {
    .features {
      height: auto;
    }

    .feature-card {
      position: relative;
      height: auto;
      opacity: 1;
      padding: 3rem 0;
    }

    .feature-content, .feature-image {
      order: unset !important;
    }

    .stats {
      flex-direction: column;
      gap: 1rem;
    }
  }
</style>

<script>
  const featureCards = document.querySelectorAll('.feature-card');
  
  const handleScroll = () => {
    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
    const viewportHeight = window.innerHeight;
    
    featureCards.forEach((card, index) => {
      const cardElement = card as HTMLElement;
      const triggerPoint = Math.floor(index * viewportHeight * 0.8);
      const nextTriggerPoint = Math.floor((index + 1) * viewportHeight * 1.2);
      
      if (scrollTop >= triggerPoint && scrollTop < nextTriggerPoint) {
        cardElement.classList.add('visible');
        cardElement.style.zIndex = '2';
      } else {
        cardElement.classList.remove('visible');
        cardElement.style.zIndex = '1';
      }
    });
  };

  // Use requestAnimationFrame for smoother scrolling
  let ticking = false;
  window.addEventListener('scroll', () => {
    if (!ticking) {
      window.requestAnimationFrame(() => {
        handleScroll();
        ticking = false;
      });
      ticking = true;
    }
  });

  // Initial check
  handleScroll();
</script>
